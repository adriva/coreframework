{
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "http://adriva.com/schemas/2022/report-definition",
    "definitions": {
        "options": {
            "$id": "/defs/options",
            "type": "object",
            "default": {},
            "title": "Dynamic options.",
            "description": "Provides an object of dynamic options that may be platform dependent that are not necessarily recognized by the core reporting infrastructure.",
            "additionalProperties": true
        },
        "dataTypes": {
            "type": "string",
            "default": "String",
            "enum": [
                "Boolean",
                "DateTime",
                "Decimal",
                "Double",
                "Empty",
                "Int32",
                "Int64",
                "String"
            ]
        },
        "fieldDefinition": {
            "properties": {
                "displayName": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null
                },
                "options": {
                    "$ref": "#/definitions/options"
                }
            }
        },
        "dataBoundType": {
            "properties": {
                "dataSource": {
                    "type": "string"
                },
                "command": {
                    "type": "string"
                },
                "fields": {
                    "type": "object",
                    "title": "Field definitions for the given data source / command pair",
                    "patternProperties": {
                        "\\w+": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/fieldDefinition"
                                }
                            ]
                        }
                    },
                    "minProperties": 1
                }
            }
        }
    },
    "type": "object",
    "title": "Report definition",
    "description": "JSON formatted definition of the dynamic report.",
    "default": {},
    "required": [
        "name"
    ],
    "properties": {
        "base": {
            "$id": "#/properties/base",
            "type": "string",
            "title": "Base report that will be merged with this one.",
            "description": "Name of the base report definition file that will be merged with this report definition.",
            "default": ""
        },
        "name": {
            "$id": "#/properties/name",
            "type": "string",
            "title": "Name of the report.",
            "description": "The name of the report this JSON defines.",
            "default": "",
            "examples": [
                "Report Name"
            ]
        },
        "contextProvider": {
            "$id": "#/properties/contextProvider",
            "type": [
                "string",
                "null"
            ],
            "title": "Context data provider.",
            "description": "Provides a type that provdes data which is not bound to a specific data source, but retrieved from the specified type in runtime.",
            "default": null,
            "examples": [
                "namespace.typename,assemblyname"
            ]
        },
        "dataSources": {
            "$id": "#/properties/dataSources",
            "type": "object",
            "title": "List of data sources that are available.",
            "description": "Provides a list of data source configurations that are available to this report as well as all reports inherited from this one to populate filter and output data in runtime.",
            "default": {},
            "patternProperties": {
                "\\w+": {
                    "type": "object",
                    "default": {
                        "type": "",
                        "connectionString": ""
                    },
                    "properties": {
                        "connectionString": {
                            "type": "string"
                        },
                        "type": {
                            "type": "string",
                            "examples": [
                                "SqlServer",
                                "Enum"
                            ]
                        },
                        "options": {
                            "$ref": "#/definitions/options"
                        }
                    },
                    "required": [
                        "connectionString",
                        "type"
                    ]
                }
            },
            "additionalProperties": true
        },
        "commands": {
            "$id": "#/properties/commands",
            "type": "object",
            "title": "List of commands.",
            "description": "Provides a list of command configurations that are available to this report as well as all reports inherited from this one.",
            "default": {
                "commandName": {
                    "commandText": "COMMAND"
                }
            },
            "patternProperties": {
                "\\w+": {
                    "type": "object",
                    "default": {
                        "commandText": "COMMAND"
                    },
                    "properties": {
                        "commandText": {
                            "type": "string",
                            "minLength": 1
                        },
                        "options": {
                            "$ref": "#/definitions/options"
                        }
                    },
                    "required": [
                        "commandText"
                    ]
                }
            },
            "required": [],
            "additionalProperties": true
        },
        "filters": {
            "$id": "#/properties/filters",
            "type": "object",
            "title": "Defines filters that are available",
            "description": "Defines the filters that may be used to filter the default output of the report.",
            "default": {},
            "patternProperties": {
                "\\w+": {
                    "allOf": [
                        {
                            "$ref": "#/definitions/dataBoundType"
                        }
                    ],
                    "properties": {
                        "displayName": {
                            "type": "string",
                            "minLength": 1
                        },
                        "defaultValue": {
                            "default": null,
                            "type": [
                                "string",
                                "number",
                                "integer",
                                "boolean",
                                "null"
                            ]
                        },
                        "properties": {
                            "type": "string",
                            "minLength": 1,
                            "examples": [
                                "Default",
                                "Constant",
                                "Context",
                                "Required"
                            ]
                        },
                        "dataType": {
                            "$ref": "#/definitions/dataTypes"
                        },
                        "children": {
                            "$ref": "#/properties/filters"
                        }
                    }
                }
            },
            "additionalProperties": true
        },
        "output": {
            "$id": "#/properties/output",
            "type": "object",
            "title": "The output schema",
            "description": "An explanation about the purpose of this instance.",
            "default": {},
            "examples": [
                {
                    "command": "getUsers",
                    "dataSource": "DefaultSqlServer",
                    "fields": {
                        "Id": {
                            "displayName": "Aydi",
                            "options": {
                                "web": {
                                    "formatter": "xx1",
                                    "format": "C2"
                                }
                            }
                        },
                        "firstName": {
                            "displayName": "Name"
                        },
                        "lastName": {}
                    }
                }
            ],
            "required": [
                "command",
                "dataSource",
                "fields"
            ],
            "properties": {
                "command": {
                    "$id": "#/properties/output/properties/command",
                    "type": "string",
                    "title": "The command schema",
                    "description": "An explanation about the purpose of this instance.",
                    "default": "",
                    "examples": [
                        "getUsers"
                    ]
                },
                "dataSource": {
                    "$id": "#/properties/output/properties/dataSource",
                    "type": "string",
                    "title": "The dataSource schema",
                    "description": "An explanation about the purpose of this instance.",
                    "default": "",
                    "examples": [
                        "DefaultSqlServer"
                    ]
                },
                "fields": {
                    "$id": "#/properties/output/properties/fields",
                    "type": "object",
                    "title": "The fields schema",
                    "description": "An explanation about the purpose of this instance.",
                    "default": {},
                    "examples": [
                        {
                            "Id": {
                                "displayName": "Aydi",
                                "options": {
                                    "web": {
                                        "formatter": "xx1",
                                        "format": "C2"
                                    }
                                }
                            },
                            "firstName": {
                                "displayName": "Name"
                            },
                            "lastName": {}
                        }
                    ],
                    "required": [
                        "Id",
                        "firstName",
                        "lastName"
                    ],
                    "properties": {
                        "Id": {
                            "$id": "#/properties/output/properties/fields/properties/Id",
                            "type": "object",
                            "title": "The Id schema",
                            "description": "An explanation about the purpose of this instance.",
                            "default": {},
                            "examples": [
                                {
                                    "displayName": "Aydi",
                                    "options": {
                                        "web": {
                                            "formatter": "xx1",
                                            "format": "C2"
                                        }
                                    }
                                }
                            ],
                            "required": [
                                "displayName",
                                "options"
                            ],
                            "properties": {
                                "displayName": {
                                    "$id": "#/properties/output/properties/fields/properties/Id/properties/displayName",
                                    "type": "string",
                                    "title": "The displayName schema",
                                    "description": "An explanation about the purpose of this instance.",
                                    "default": "",
                                    "examples": [
                                        "Aydi"
                                    ]
                                },
                                "options": {
                                    "$id": "#/properties/output/properties/fields/properties/Id/properties/options",
                                    "type": "object",
                                    "title": "The options schema",
                                    "description": "An explanation about the purpose of this instance.",
                                    "default": {},
                                    "examples": [
                                        {
                                            "web": {
                                                "formatter": "xx1",
                                                "format": "C2"
                                            }
                                        }
                                    ],
                                    "required": [
                                        "web"
                                    ],
                                    "properties": {
                                        "web": {
                                            "$id": "#/properties/output/properties/fields/properties/Id/properties/options/properties/web",
                                            "type": "object",
                                            "title": "The web schema",
                                            "description": "An explanation about the purpose of this instance.",
                                            "default": {},
                                            "examples": [
                                                {
                                                    "formatter": "xx1",
                                                    "format": "C2"
                                                }
                                            ],
                                            "required": [
                                                "formatter",
                                                "format"
                                            ],
                                            "properties": {
                                                "formatter": {
                                                    "$id": "#/properties/output/properties/fields/properties/Id/properties/options/properties/web/properties/formatter",
                                                    "type": "string",
                                                    "title": "The formatter schema",
                                                    "description": "An explanation about the purpose of this instance.",
                                                    "default": "",
                                                    "examples": [
                                                        "xx1"
                                                    ]
                                                },
                                                "format": {
                                                    "$id": "#/properties/output/properties/fields/properties/Id/properties/options/properties/web/properties/format",
                                                    "type": "string",
                                                    "title": "The format schema",
                                                    "description": "An explanation about the purpose of this instance.",
                                                    "default": "",
                                                    "examples": [
                                                        "C2"
                                                    ]
                                                }
                                            },
                                            "additionalProperties": true
                                        }
                                    },
                                    "additionalProperties": true
                                }
                            },
                            "additionalProperties": true
                        },
                        "firstName": {
                            "$id": "#/properties/output/properties/fields/properties/firstName",
                            "type": "object",
                            "title": "The firstName schema",
                            "description": "An explanation about the purpose of this instance.",
                            "default": {},
                            "examples": [
                                {
                                    "displayName": "Name"
                                }
                            ],
                            "required": [
                                "displayName"
                            ],
                            "properties": {
                                "displayName": {
                                    "$id": "#/properties/output/properties/fields/properties/firstName/properties/displayName",
                                    "type": "string",
                                    "title": "The displayName schema",
                                    "description": "An explanation about the purpose of this instance.",
                                    "default": "",
                                    "examples": [
                                        "Name"
                                    ]
                                }
                            },
                            "additionalProperties": true
                        },
                        "lastName": {
                            "$id": "#/properties/output/properties/fields/properties/lastName",
                            "type": "object",
                            "title": "The lastName schema",
                            "description": "An explanation about the purpose of this instance.",
                            "default": {},
                            "examples": [
                                {}
                            ],
                            "required": [],
                            "additionalProperties": true
                        }
                    },
                    "additionalProperties": true
                }
            },
            "additionalProperties": true
        }
    },
    "additionalProperties": true
}